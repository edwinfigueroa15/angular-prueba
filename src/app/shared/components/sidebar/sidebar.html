<!-- sidebar.component.html -->
<aside
    class="sidenav transition-all duration-300 bg-gray-100 scroll shadow z-50"
    [ngClass]="isCollapsed() && !isHovered() ? 'w-0 px-0 sm:w-16 sm:px-2' : 'w-64 px-2'" (mouseenter)="onMouseEnter()"
    (mouseleave)="onMouseLeave()"
>
    <ul class="mt-4 space-y-2">
        @for (item of menuItems; track i; let i = $index) {
        <li>
            <!-- ITEM SIN HIJOS -->
            @if (!item.children) {
            <a 
                [routerLink]="item.route"
                routerLinkActive="bg-primary text-white"
                class="flex items-center p-2 rounded-md h-10 hover:bg-primary hover:text-white transition-colors overflow-hidden text-ellipsis whitespace-nowrap"
            >
                <div class="flex items-center" [ngClass]="isCollapsed() && !isHovered() ? 'w-full justify-center' : ''">
                    <i [class]="item.icon"></i>
                </div>
                @if (!isCollapsed() || isHovered()) {
                <span class="ml-3 overflow-hidden text-ellipsis whitespace-nowrap">{{ item.label }}</span>
                }
            </a>
            }

            <!-- ITEM CON HIJOS -->
            @if (item.children) {
            <div>
                <button
                    class="flex w-full items-center justify-between p-2 rounded-md h-10 hover:bg-primary hover:text-white transition-colors overflow-hidden text-ellipsis whitespace-nowrap"
                    (click)="toggleSubmenu(i)"
                >
                    <div class="flex items-center" [ngClass]="isCollapsed() && !isHovered() ? 'w-full justify-center' : ''">
                        <i [class]="item.icon"></i>
                        @if (!isCollapsed() || isHovered()) {
                        <span class="ml-3">{{ item.label }}</span>
                        }
                    </div>
                    @if (!isCollapsed() || isHovered()) {
                    <i class="pi pi-chevron-right hover:!text-white" [ngClass]="{ 'rotate-90': toggleStates[i] }"></i>
                    }
                </button>

                <!-- SUBMENÃš -->
                @if (toggleStates[i]) {
                    <ul
                        class="mt-1 space-y-1"
                        [ngClass]="isCollapsed() && !isHovered() ? 'ml-0' : 'ml-4'"
                    >
                      @for (child of item.children; track j; let j = $index) {
                        <li>
                            <a 
                                [routerLink]="child.route"
                                routerLinkActive="bg-primary-400 text-white"
                                [routerLinkActiveOptions]="{ exact: true }"
                                class="flex items-center p-2 rounded-md h-10 hover:bg-primary-400 hover:text-white transition-colors overflow-hidden text-ellipsis whitespace-nowrap"
                            >
                                <div class="flex items-center" [ngClass]="isCollapsed() && !isHovered() ? 'w-full justify-center' : ''">
                                    <i [class]="child.icon"></i>
                                </div>
                                @if (!isCollapsed() || isHovered()) {
                                <span class="ml-3 overflow-hidden">{{ child.label }}</span>
                                }
                            </a>
                        </li>
                      }
                    </ul>
                }
            </div>
            }
        </li>
        }
    </ul>
</aside>